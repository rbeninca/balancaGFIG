<!doctype html><html lang=pt-BR><meta charset=UTF-8><meta name=viewport content="width=device-width,initial-scale=1"><title>GFIG ğŸš€ - BalanÃ§a Wi-Fi</title><script src=apexcharts></script><link rel=stylesheet href=estilo.css><script src=script_grafico_sessao.js defer></script><script src=funcoespdf.js defer></script><script src=script.js defer></script><script src=martelo-do-thor.js defer></script><div id=countdown-overlay><div id=countdown-circle><div id=countdown-number></div><div id=countdown-hand></div></div><button id=btn-cancelar-countdown class="btn btn-perigo">Cancelar GravaÃ§Ã£o</button></div><div class=container><div id=alerta-estabilizacao>âš ï¸ A balanÃ§a nÃ£o estÃ¡ estabilizando! A tolerÃ¢ncia pode estar muito baixa. VÃ¡ em ParÃ¢metros â†’ TolerÃ¢ncia de Estabilidade e aumente o valor.</div><div class=sticky-header-group><div class=leituras-display><div class=leituras-valores id=leituras-container title="Clique para alternar a unidade de medida (kgf, N, gf)" style=cursor:pointer><div title="ForÃ§a atual sendo medida pela cÃ©lula de carga em tempo real"><h4>ForÃ§a Atual</h4><p id=forca-atual>---</div><div title="Maior forÃ§a registrada desde que o grÃ¡fico foi limpo ou iniciado"><h4>ForÃ§a MÃ¡xima</h4><p id=forca-maxima>---</p><small id=forca-minima style=display:block;font-size:.75rem;color:var(--cor-texto-secundario)>mÃ­n: ---</small></div><div title="Taxa de atualizaÃ§Ã£o: quantas leituras a balanÃ§a estÃ¡ enviando por segundo"><h4>Leituras/Seg</h4><p id=leituras-por-segundo>---</div></div><div class=barra-esforco-celula style=margin-top:.5rem;margin-bottom:.5rem><div class=barra-esforco-container><div id=barra-esforco-fill class=barra-esforco-fill><span id=barra-esforco-texto class=barra-esforco-texto>--- | 0%</span></div><div class=barra-esforco-marcadores style=font-size:.6rem;margin-top:1px><span class=barra-esforco-marcador style=left:50% title="InÃ­cio da Zona de AtenÃ§Ã£o">50%</span> <span class=barra-esforco-marcador style=left:70% title="Zona de Cuidado">70%</span> <span class=barra-esforco-marcador style=left:80% title="Zona de Perigo">80%</span> <span class=barra-esforco-marcador style=left:90% title="Zona CrÃ­tica">90%</span></div></div></div></div><div class=nav-abas><nav><button class=tablink onclick='abrirAba(this,"abaGrafico")' id=padrao>ğŸ“ˆ GrÃ¡fico</button> <button class=tablink onclick='abrirAba(this,"abaTabela")'>ğŸ“‹ Tabela</button> <button class=tablink onclick='abrirAba(this,"abaGravacoes")'>ğŸ’¾ GravaÃ§Ãµes</button> <button class=tablink onclick='abrirAba(this,"abaControles")'>âš™ï¸ ParÃ¢metros</button> <button class=tablink onclick='abrirAba(this,"abaMartelo")'>âš¡ Martelo do Thor</button> <button class=tablink onclick='abrirAba(this,"abaConexao")'>ğŸ”Œ ConexÃ£o</button> <button class=tablink onclick='window.open("creditos.html","_blank")'>CrÃ©ditos</button> <button id=btn-open-wizard class=btn-wizard title="Assistente de configuraÃ§Ã£o da balanÃ§a">ğŸ§™â€â™‚ï¸ ConfiguraÃ§Ã£o Guiada</button></nav></div></div><main><div id=abaGrafico class=tabcontent><div class=controles-grafico-sessao style=margin-bottom:.5rem;display:flex;flex-wrap:wrap;gap:.5rem><button id=btn-abrir-modal-sessao class="btn btn-sucesso" style="font-size:1rem;padding:.75rem 1.5rem">ğŸš€ Nova SessÃ£o de Teste</button> <button id=btn-encerrar-sessao onclick=encerrarSessao() class="btn btn-perigo" style="font-size:1rem;padding:.75rem 1.5rem" disabled>â¹ Encerrar SessÃ£o</button></div><div id=mensagem-gravacao style=display:none><span class=record-dot></span> <span id=tempo-gravacao>Gravando 0s...</span></div><div class=grafico-e-controles style=display:flex;align-items:flex-start;gap:1rem;flex-wrap:nowrap><div id=grafico class=ct-chart style=flex-grow:1></div><div class=controles-laterais style=display:flex;flex-direction:column;gap:.5rem><div style="display:flex;align-items:center;gap:.5rem;padding:.5rem;border:1px solid var(--cor-borda);border-radius:.5rem"><label for=max-data-points-input id=max-data-points-label>Max Pontos:</label> <input type=number id=max-data-points-input value=100 min=10 step=10 style=width:80px title="NÃºmero mÃ¡ximo de pontos no modo deslizante. No modo acumulado, mostra a contagem atual."></div><div class=btn-grupo><button id=btn-toggle-labels class=btn onclick=toggleDataLabels() title="Mostrar ou ocultar os valores numÃ©ricos nos pontos do grÃ¡fico">Mostrar/Ocultar Labels</button> <button id=btn-toggle-display-mode class=btn onclick=toggleChartDisplayMode() title="Alternar entre: somente pontos, somente linha ou pontos + linha">Modo: Somente Pontos</button> <button id=btn-toggle-grid class=btn onclick=toggleGrid() title="Mostrar ou ocultar a grade de referÃªncia do grÃ¡fico">Grade: ON</button> <button id=btn-set-smooth-line class=btn onclick='setInterpolation("smooth")' title="Linha suavizada (interpolaÃ§Ã£o cardinal) - melhor visualizaÃ§Ã£o">Linha Suave</button> <button id=btn-set-straight-line class=btn onclick='setInterpolation("straight")' title="Linha reta entre pontos (interpolaÃ§Ã£o linear) - dados brutos">Linha Reta</button></div><div class=btn-grupo><button id=btn-toggle-fullscreen class=btn onclick=toggleFullscreen() title="Expandir grÃ¡fico para tela cheia (melhor visualizaÃ§Ã£o)">Tela Cheia</button> <button class=btn onclick='setYAxisRange("auto")' title="Eixo Y ajusta automaticamente aos valores exibidos">Range AutomÃ¡tico</button> <button class=btn onclick='setYAxisRange("fixed")' title="Eixo Y fixo de 0 atÃ© a capacidade mÃ¡xima da cÃ©lula">Range Fixo (CÃ©lula)</button></div><div class=btn-grupo><button id=btn-anti-noising class=btn onclick=toggleAntiNoising() title="Filtro que remove ruÃ­do atravÃ©s de mÃ©dia mÃ³vel exponencial">Anti-Noising: Off</button> <button id=btn-zona-morta class=btn onclick=toggleFiltroZonaMorta() style=background:#27ae60 title="Ignora variaÃ§Ãµes pequenas prÃ³ximas a zero (elimina deriva)">Zona Morta: ON</button> <button id=btn-arredondamento class=btn onclick=toggleArredondamentoInteligente() style=background:#27ae60 title="Arredonda valores conforme a acurÃ¡cia da cÃ©lula (reduz ruÃ­do)">Arredondar: ON</button></div><div id=status-filtros style=margin-top:.5rem;padding:.5rem;background:#ecf0f1;border-radius:.5rem;font-size:.875rem><strong>ğŸ“Š Filtros da CÃ©lula:</strong> <span id=info-zona-morta style=margin-left:1rem;color:#27ae60>âœ“ Zona Morta (Â±0.0g)</span> <span id=info-arredondamento style=margin-left:1rem;color:#27ae60>âœ“ Arredondamento (0 casas)</span></div><div class=btn-grupo style=flex-direction:column><button id=btn-deslizante class=btn onclick='setChartMode("deslizante")' title="Modo deslizante: mantÃ©m apenas os Ãºltimos N pontos (janela mÃ³vel)">Deslizante</button> <button id=btn-acumulado class=btn onclick='setChartMode("acumulado")' title="Modo acumulado: armazena todos os pontos sem limite">Acumulado</button> <button id=btn-pausado class=btn onclick=toggleChartPause() title="Pausar atualizaÃ§Ã£o do grÃ¡fico (dados continuam sendo recebidos)">Pausar/Retomar</button> <button onclick=clearChart() class="btn btn-secundario" title="Limpar todos os dados do grÃ¡fico e resetar valores mÃ¡ximo/mÃ­nimo">Limpar GrÃ¡fico</button></div></div></div></div><div id=abaTabela class=tabcontent><div class=tabela-container><table id=tabela><thead><tr><th>Timestamp<th>Tempo ESP (s)<th>Newtons (N)<th>Grama-forÃ§a (gf)<th>Quilo-forÃ§a (kgf)<tbody></table></div></div><div id=abaControles class=tabcontent><section><h2 style=font-size:1.25rem;font-weight:600;margin-bottom:.5rem>ParÃ¢metros da BalanÃ§a <span style="font-size:.7rem;color:var(--cor-info);font-weight:400;background:var(--cor-info-light);padding:.25rem .5rem;border-radius:.25rem">ğŸ’¾ Salvos no ESP32</span></h2><p style=font-size:.875rem;color:var(--cor-texto-secundario);margin-bottom:1rem>Estes valores sÃ£o armazenados na memÃ³ria do ESP32 e recuperados automaticamente ao reiniciar.<div class=grid-container style=gap:1rem><div><label for=param-conversao title="Fator de conversÃ£o especÃ­fico da sua cÃ©lula de carga (obtido na calibraÃ§Ã£o)">Fator de ConversÃ£o</label> <input id=param-conversao type=number step=any title="Valor calibrado que converte leitura bruta em forÃ§a (N). Obtido durante calibraÃ§Ã£o."></div><div><label for=param-gravidade title="AceleraÃ§Ã£o da gravidade local em m/sÂ² (varia com altitude e latitude)">Gravidade (m/sÂ²)</label> <input id=param-gravidade type=number step=any title="Valor padrÃ£o: 9.80665 m/sÂ². Ajuste conforme sua localizaÃ§Ã£o geogrÃ¡fica."></div><div><label for=param-offset title="Offset de tara salvo permanentemente no ESP32">Offset de Tara Salvo</label> <input id=param-offset style="padding:.5rem .75rem;background-color:#f9fafb;border:1px solid #d1d5db;border-radius:.375rem" readonly title="Valor de tara aplicado (somente leitura). Use Shift+T para tarar."></div></div><h3 style=font-size:1.125rem;font-weight:600;margin-top:1.5rem;margin-bottom:.5rem>âš–ï¸ EspecificaÃ§Ãµes da CÃ©lula de Carga <span style="font-size:.7rem;color:var(--cor-info);font-weight:400;background:var(--cor-info-light);padding:.25rem .5rem;border-radius:.25rem">ğŸ’¾ Salvos no ESP32</span></h3><p style=font-size:.875rem;color:var(--cor-texto-secundario);margin-bottom:.75rem>Configure a capacidade e precisÃ£o da sua cÃ©lula. Valores salvos na memÃ³ria nÃ£o-volÃ¡til do ESP32.<div class=grid-container style=gap:1rem><div><label for=param-capacidade-maxima title="Capacidade mÃ¡xima nominal da sua cÃ©lula de carga">Capacidade MÃ¡xima (g)</label> <input id=param-capacidade-maxima type=number step=any oninput=atualizarCapacidadeEmKg() title="Ex: 5000g para cÃ©lula de 5kg. Usado para range fixo do grÃ¡fico."> <small id=capacidade-em-kg style=color:var(--cor-texto-secundario);display:block;margin-top:.25rem>â‰ˆ 5.00 kg</small></div><div><label for=param-acuracia title="PrecisÃ£o da cÃ©lula conforme datasheet (classe de precisÃ£o)">AcurÃ¡cia (%)</label> <input id=param-acuracia type=number step=0.001 oninput=atualizarErroAbsoluto() title="Percentual de erro da cÃ©lula. Ex: 0.03% = classe C3, 0.1% = classe D1"> <small id=erro-absoluto style=color:var(--cor-texto-secundario);display:block;margin-top:.25rem>Erro: Â±0.00 g</small> <small style=color:var(--cor-info);display:block;margin-top:.25rem>ğŸ’¡ Valores tÃ­picos: 0.03% a 0.1%</small></div></div><h3 style=font-size:1.125rem;font-weight:600;margin-top:1.5rem;margin-bottom:.5rem>ParÃ¢metros de EstabilizaÃ§Ã£o <span style="font-size:.7rem;color:var(--cor-info);font-weight:400;background:var(--cor-info-light);padding:.25rem .5rem;border-radius:.25rem">ğŸ’¾ Salvos no ESP32</span></h3><p style=font-size:.875rem;color:var(--cor-texto-secundario);margin-bottom:.75rem>ParÃ¢metros que controlam quando a balanÃ§a considera a leitura estÃ¡vel. Armazenados no ESP32.<div class=grid-container style=gap:1rem><div><label for=param-leituras-estaveis title="Quantas leituras consecutivas dentro da tolerÃ¢ncia para considerar estÃ¡vel">Leituras EstÃ¡veis</label> <input id=param-leituras-estaveis type=number title="NÃºmero de amostras consecutivas que devem estar dentro da tolerÃ¢ncia. PadrÃ£o: 3-5"></div><div><label for=param-tolerancia title="VariaÃ§Ã£o mÃ¡xima permitida entre leituras para considerar estÃ¡vel">TolerÃ¢ncia de Estabilidade</label> <input id=param-tolerancia type=number step=any oninput=atualizarToleranciaEmGramas() title="Quanto pode variar entre leituras (em Newtons). Se nÃ£o estabiliza, aumente!"> <small id=tolerancia-em-gramas style=color:var(--cor-texto-secundario);display:block;margin-top:.25rem>â‰ˆ 0.00 g</small> <small style=color:var(--cor-aviso);display:block;margin-top:.25rem>âš ï¸ Se a balanÃ§a nÃ£o estabiliza, aumente este valor!</small></div><div><label for=param-num-amostras title="Quantas leituras usar para calcular a mÃ©dia de estabilizaÃ§Ã£o">NÂº Amostras para MÃ©dia</label> <input id=param-num-amostras type=number title="Quantidade de amostras para mÃ©dia mÃ³vel. Mais amostras = mais suave, mas mais lento."></div><div><label for=param-timeout title="Tempo mÃ¡ximo de espera para estabilizar durante calibraÃ§Ã£o">Timeout de CalibraÃ§Ã£o (ms)</label> <input id=param-timeout type=number title="Milissegundos de espera mÃ¡xima. Se exceder, calibraÃ§Ã£o falha. PadrÃ£o: 5000-10000ms"></div><div><label for=taxa-atualizacao title="Intervalo entre atualizaÃ§Ãµes do grÃ¡fico (nÃ£o afeta leitura da balanÃ§a)">Taxa de AtualizaÃ§Ã£o do GrÃ¡fico (ms)</label> <input id=taxa-atualizacao type=number min=10 max=1000 step=10 value=100 title="Intervalo em milissegundos. 100ms = 10 atualizaÃ§Ãµes/seg. Menor = mais responsivo"> <small id=taxa-info style=color:var(--cor-texto-secundario);display:block;margin-top:.25rem>â‰ˆ 10 atualizaÃ§Ãµes/seg</small></div></div><button onclick=salvarParametros() class="btn btn-sucesso" style=margin-top:1.5rem title="Salvar todos os parÃ¢metros na memÃ³ria nÃ£o-volÃ¡til do ESP32">ğŸ’¾ Salvar Todos os ParÃ¢metros no ESP32</button></section><section style="margin-top:2rem;padding-top:1.5rem;border-top:1px solid var(--cor-borda)"><h3 style=font-size:1.125rem;font-weight:600;margin-bottom:.5rem>ğŸ”Š ConfiguraÃ§Ãµes de Anti-Noising</h3><p style=font-size:.875rem;color:var(--cor-texto-secundario);margin-bottom:1rem>Configure a anÃ¡lise e reduÃ§Ã£o de ruÃ­do da balanÃ§a. Use <kbd>Shift+A</kbd> para iniciar anÃ¡lise de ruÃ­do.<div class=grid-container style=gap:1rem><div><label for=anti-noising-multiplier title="Controla a agressividade do filtro anti-ruÃ­do">Multiplicador de Threshold</label> <input id=anti-noising-multiplier type=number step=0.1 min=0.5 max=10 value=2.0 oninput=setAntiNoisingMultiplier(this.value),atualizarInfoMultiplier() title="Multiplicador do desvio padrÃ£o para definir o limiar de ruÃ­do. 2.0x = filtro moderado, 3.0x = agressivo"> <small id=info-multiplier style=color:var(--cor-texto-secundario);display:block;margin-top:.25rem>Valor atual: 2.0x desvio padrÃ£o </small><small style=color:var(--cor-info);display:block;margin-top:.25rem>ğŸ’¡ Valores maiores = mais agressivo na remoÃ§Ã£o de ruÃ­do</small></div><div><label>AÃ§Ãµes de AnÃ¡lise de RuÃ­do</label><div style=display:flex;gap:.5rem;flex-wrap:wrap;margin-top:.5rem><button onclick=startNoiseAnalysis() class="btn btn-info" title="Inicia anÃ¡lise do ruÃ­do sem carga para calcular desvio padrÃ£o e threshold ideal">ğŸ” Analisar RuÃ­do (Shift+A)</button> <button onclick=resetNoiseAnalysis() class="btn btn-secundario">ğŸ”„ Resetar AnÃ¡lise</button></div><small style=color:var(--cor-texto-secundario);display:block;margin-top:.5rem>A anÃ¡lise leva 5 segundos com a balanÃ§a vazia e estÃ¡vel</small></div></div></section><div style="margin-top:2rem;padding-top:1.5rem;border-top:1px solid var(--cor-borda)"><div class=grid-container><div><h3>Comando de Tara (<kbd>Shift+T</kbd>)</h3><p style=font-size:.875rem;color:var(--cor-texto-secundario);margin-bottom:.75rem>Zera a balanÃ§a. Use com o prato vazio.</p><button onclick=tare() class="btn btn-primario">Zerar (Tara)</button></div><div><h3>CalibraÃ§Ã£o (<kbd>Shift+C</kbd>)</h3><p style=font-size:.875rem;color:var(--cor-texto-secundario);margin-bottom:.75rem>Coloque um peso de massa conhecida (em gramas) e digite o valor.<div style=display:flex;align-items:center;gap:.5rem><input id=massaCalibracao type=number step=any placeholder="Massa em gramas" style=width:12rem><button onclick=calibrar() class="btn btn-aviso">Calibrar</button></div></div></div></div></div><div id=abaGravacoes class=tabcontent><div style=display:flex;justify-content:flex-end;margin-bottom:1rem><button onclick=abrirModalImportacao() class="btn btn-info" style="font-size:1rem;padding:.75rem 1.5rem">ğŸ“¥ Importar GravaÃ§Ã£o</button></div><div id=lista-gravacoes style=display:flex;flex-direction:column;gap:.75rem></div></div><div id=modal-importacao class=wizard-modal><div class=wizard-content><div class=wizard-header><h2>ğŸ“¥ Importar GravaÃ§Ã£o</h2><button class=wizard-close onclick=fecharModalImportacao()>&times;</button></div><div class=wizard-body><div class=wizard-step style=display:block><div style="padding:1rem;border:1px dashed var(--cor-borda);border-radius:.5rem;margin-bottom:1.5rem"><h3 style=font-size:1rem;font-weight:600;margin-bottom:.5rem>ğŸ“¥ Importar Teste EstÃ¡tico (.txt)</h3><p style=font-size:.75rem;color:var(--cor-texto-secundario);margin-bottom:.75rem>Importe arquivos de texto (ex: saÃ­das de simulaÃ§Ã£o FxT) no formato *tempo [s] forÃ§a [N]*.</p><input type=file id=importar-arquivo-motor accept=.txt,.log style=width:auto;margin-right:10px title="Selecione um arquivo .txt ou .log com dados de forÃ§a ao longo do tempo"> <input id=nome-importacao placeholder="Nome da sessÃ£o importada" style=max-width:200px title="Nome identificador para a sessÃ£o importada"> <button onclick=importarGravacaoExterna() class="btn btn-info" style=margin-top:10px title="Processar e salvar o arquivo importado no banco de dados">Salvar ImportaÃ§Ã£o</button></div><div style="padding:1rem;border:1px dashed var(--cor-primaria);border-radius:.5rem;margin-bottom:1.5rem;background:rgba(52,152,219,.05)"><h3 style=font-size:1rem;font-weight:600;margin-bottom:.5rem>ğŸ“¤ Importar GravaÃ§Ã£o Exportada (.json)</h3><p style=font-size:.75rem;color:var(--cor-texto-secundario);margin-bottom:.75rem>Restaure gravaÃ§Ãµes previamente exportadas em formato JSON. Todas as informaÃ§Ãµes da sessÃ£o serÃ£o recuperadas.</p><input type=file id=importar-json accept=.json,application/json style=width:auto;margin-right:10px title="Selecione um arquivo JSON exportado anteriormente desta aplicaÃ§Ã£o"> <button onclick=importarGravacaoJSON() class="btn btn-sucesso" style=margin-top:10px title="Restaurar sessÃ£o completa a partir do arquivo JSON">ğŸ“¥ Importar JSON</button></div></div></div><div class=wizard-footer><button onclick=fecharModalImportacao() class="btn btn-secundario">Fechar</button></div></div></div><hr style="border:0;border-top:1px solid var(--cor-borda);margin:2rem 0"></main></div><div id=abaMartelo class=tabcontent><div style=text-align:center;padding:2rem><h1 style=font-size:2.5rem;margin-bottom:1rem>ğŸ® COLEÃ‡ÃƒO DE JOGOS ğŸ®</h1><p style=font-size:1.25rem;color:var(--cor-texto-secundario);margin-bottom:1rem>Inclui: Martelo do Thor + 8 Templates de Jogos<p style=font-size:1rem;color:var(--cor-texto-secundario);margin-bottom:2rem>Teste sua forÃ§a e compita com outros jogadores em diferentes desafios! âš¡</p><button onclick=abrirMarteloFullscreen() style="padding:1.5rem 3rem;font-size:1.5rem;font-weight:700;background:linear-gradient(135deg,#667eea 0,#764ba2 100%);color:#fff;border:none;border-radius:1rem;cursor:pointer;box-shadow:0 4px 15px rgba(0,0,0,.2);transition:all .3s ease;text-transform:uppercase;letter-spacing:2px" onmouseover='this.style.transform="scale(1.05)"' onmouseout='this.style.transform="scale(1)"'>ğŸ® ABRIR COLEÃ‡ÃƒO DE JOGOS</button><p style=margin-top:2rem;color:var(--cor-texto-secundario)>Selecione um jogo e comece a jogar!</div></div><small style=display:block;color:rgba(255,255,255,.8)>ForÃ§a em tempo real</small><div id=abaConexao class=tabcontent><h2 style=font-size:1.25rem;font-weight:600;margin-bottom:.5rem>ConfiguraÃ§Ãµes de ConexÃ£o</h2><p style=font-size:.875rem;color:var(--cor-texto-secundario);margin-bottom:1rem>Configure o endereÃ§o do servidor WebSocket para ambientes de desenvolvimento.<div><label for=ws-url>URL do Servidor WebSocket</label> <input id=ws-url placeholder=ws://[2804:4950:1:803e:78c5:d2ff:fe30:2650]:81 title="URL completa do servidor WebSocket (ws:// para IPv4 ou IPv6 entre colchetes)"> <span class=info-text style=font-size:.85em;color:var(--cor-texto-secundario);margin-top:.5rem;display:block>Ex: ws://seu_endereco_ipv4:81 ou ws://[seu_endereco_ipv6]:81</span></div><div id=ws-url-controls style=display:flex;gap:.5rem;margin-top:1rem><button id=btn-salvar-ws-url onclick=salvarWsUrl() class="btn btn-sucesso" title="Salvar URL e reconectar imediatamente ao servidor WebSocket">Salvar e Reconectar</button> <button id=btn-resetar-ws-url onclick=resetarWsUrl() class="btn btn-secundario" title="Restaurar URL padrÃ£o do servidor WebSocket (auto-detecta)">ğŸ”„ Restaurar PadrÃ£o</button></div></div><footer id=footer-atalhos><div class="footer-section footer-brand"><h3>ğŸš€ GFIG - BalanÃ§a Serial</h3></div><div class="footer-section footer-status"><div class=status-item title="ConexÃ£o WebSocket com o servidor Python - transmite dados da balanÃ§a em tempo real"><span class=status-label>WebSocket:</span><div id=ws-indicator class=status-indicator title=Desconectado></div><span id=ws-text>Desconectado</span></div><div class=status-item title="ConexÃ£o com banco de dados MySQL - necessÃ¡ria para salvar gravaÃ§Ãµes"><span class=status-label>MySQL:</span><div id=mysql-indicator class=status-indicator title="MySQL Desconectado"></div><span id=mysql-text>Desconectado</span></div><div class=status-item title="Status de comunicaÃ§Ã£o da balanÃ§a com o ESP32"><span class=status-label>âš–ï¸ BalanÃ§a:</span> <span id=balanca-status>...</span></div></div><div class="footer-section footer-time"><span class=time-label title="HorÃ¡rio atual do servidor (UTC-3 - America/Sao_Paulo)">ğŸ• Servidor:</span> <span id=server-clock>--:--:--</span> <button onclick=syncServerTime() class="btn btn-sync" title="Sincronizar relÃ³gio do servidor com a hora do seu navegador">ğŸ”„</button></div><div class="footer-section footer-shortcuts"><span class=shortcuts-title>âš¡ ATALHOS:</span><div class=shortcuts-grid><span class=shortcut-item><span class=shortcut-label>Tara:</span> <kbd>Shift</kbd>+<kbd>T</kbd></span> <span class=shortcut-item><span class=shortcut-label>CalibraÃ§Ã£o:</span> <kbd>Shift</kbd>+<kbd>C</kbd></span> <span class=shortcut-item><span class=shortcut-label>RuÃ­do:</span> <kbd>Shift</kbd>+<kbd>A</kbd></span> <span class=shortcut-item><span class=shortcut-label>Debug:</span> <kbd>Shift</kbd>+<kbd>D</kbd></span> <span class=shortcut-item><span class=shortcut-label>Pausar:</span> <kbd>P</kbd></span> <span class=shortcut-item><span class=shortcut-label>Limpar:</span> <kbd>L</kbd></span></div></div><div class="footer-section footer-theme"><button id=theme-toggle class=btn-theme-toggle title="Alternar tema">ğŸŒ™</button></div></footer><div id=notification-area></div><div id=modal-alerta-sobrecarga class=modal-sobrecarga><div class=modal-sobrecarga-content><div class=modal-sobrecarga-header><span class=modal-sobrecarga-icone>âš ï¸</span><h2 id=modal-sobrecarga-titulo>ATENÃ‡ÃƒO: APROXIMANDO DO LIMITE!</h2></div><div class=modal-sobrecarga-body><div class=modal-sobrecarga-display><div class=modal-sobrecarga-valor><span class=modal-sobrecarga-label>Carga Atual:</span> <span id=modal-sobrecarga-valor-atual class=modal-sobrecarga-numero>---</span></div><div class=modal-sobrecarga-barra><div id=modal-sobrecarga-barra-progresso class=modal-sobrecarga-barra-fill></div><span id=modal-sobrecarga-percentual class=modal-sobrecarga-percentual-texto>0%</span></div><div class=modal-sobrecarga-limite><span class=modal-sobrecarga-label>Limite MÃ¡ximo:</span> <span id=modal-sobrecarga-valor-limite class=modal-sobrecarga-numero>---</span></div></div><div class=modal-sobrecarga-aviso><p id=modal-sobrecarga-mensagem>âš ï¸ VocÃª estÃ¡ prÃ³ximo do limite da cÃ©lula de carga!<br><strong>RISCO DE DANOS PERMANENTES AO EQUIPAMENTO!</strong><p class=modal-sobrecarga-instrucao>Reduza a carga imediatamente para evitar a destruiÃ§Ã£o da cÃ©lula.</div></div><div class=modal-sobrecarga-footer><button onclick=fecharModalSobrecarga() class=btn-modal-sobrecarga-ok>Entendi - Fechar Alerta</button></div></div></div><div id=fullscreen-chart-modal class=fullscreen-modal-overlay><button id=btn-exit-fullscreen class="btn btn-perigo" style=position:absolute;top:30px;right:20px;z-index:1001>âœ– Sair da Tela Cheia</button></div><div id=wizard-modal class=wizard-modal><div class=wizard-content><div class=wizard-header><h2>Assistente de ConfiguraÃ§Ã£o da BalanÃ§a</h2><button class=wizard-close onclick=closeWizard()>&times;</button></div><div class=wizard-body><div class=wizard-progress><div class=wizard-progress-bar></div></div><div class=wizard-step id=wizard-step-0><h3>Bem-vindo ao Assistente de ConfiguraÃ§Ã£o!</h3><p>Este guia irÃ¡ ajudÃ¡-lo a configurar e calibrar sua balanÃ§a passo a passo.<div id=wizard-loading><p>Carregando configuraÃ§Ãµes atuais do dispositivo...<div class=spinner></div></div><div id=wizard-error style=display:none><p class=text-error>NÃ£o foi possÃ­vel carregar as configuraÃ§Ãµes. Verifique a conexÃ£o com a balanÃ§a. VocÃª pode continuar com os valores padrÃ£o.</div></div><div class=wizard-step id=wizard-step-1 style=display:none><h4>Etapa 1: ParÃ¢metros da CÃ©lula de Carga</h4><p class=wizard-explanation>Informe os dados nominais da sua cÃ©lula de carga. Essas informaÃ§Ãµes sÃ£o encontradas na folha de dados (datasheet) do componente.<div><label for=wizard-capacidade-maxima>Limite da CÃ©lula de Carga (Capacidade)</label> <input type=number id=wizard-capacidade-maxima placeholder="Ex: 5000 para 5kg"> <select id=wizard-capacidade-unidade><option value=g selected>gramas (g)<option value=kg>quilogramas (kg)<option value=N>Newtons (N)</select> <small>Capacidade mÃ¡xima que a cÃ©lula de carga suporta. Nunca exceda este valor.</small></div><div><label for=wizard-acuracia>AcurÃ¡cia/Erro da CÃ©lula (%)</label> <input type=number id=wizard-acuracia step=0.001 placeholder="Ex: 0.05"> <small>Classe de precisÃ£o ou erro percentual da cÃ©lula. Ex: 0.05% para uma cÃ©lula comum.</small></div></div><div class=wizard-step id=wizard-step-2 style=display:none><h4>Etapa 2: ParÃ¢metros de CalibraÃ§Ã£o</h4><p class=wizard-explanation>Ajuste os parÃ¢metros para o processo de calibraÃ§Ã£o. As sugestÃµes sÃ£o um bom ponto de partida.<div><label for=wizard-num-amostras>NÂº de Leituras para MÃ©dia</label> <input type=number id=wizard-num-amostras placeholder="Ex: 10"> <small>Quantidade de amostras para calcular a mÃ©dia durante a calibraÃ§Ã£o. Mais amostras = mais estÃ¡vel, porÃ©m mais lento.</small></div><div><label for=wizard-tolerancia>TolerÃ¢ncia de CalibraÃ§Ã£o (em gramas)</label> <input type=number id=wizard-tolerancia step=any placeholder="Ex: 0.5"> <small>VariaÃ§Ã£o mÃ¡xima permitida entre as leituras. Se a calibraÃ§Ã£o falhar, tente aumentar este valor.</small> <small id=wizard-tolerancia-sugestao style=color:var(--cor-info)></small></div><div><label for=wizard-timeout>Timeout de CalibraÃ§Ã£o (ms)</label> <input type=number id=wizard-timeout placeholder="Ex: 5000"> <small>Tempo mÃ¡ximo de espera para a balanÃ§a estabilizar antes de abortar a calibraÃ§Ã£o.</small></div></div><div class=wizard-step id=wizard-step-3 style=display:none><h4>Etapa 3: Guia de Tara e CalibraÃ§Ã£o</h4><div class=wizard-substep><p><strong>1. Posicione a CÃ©lula:</strong> Coloque a cÃ©lula de carga na posiÃ§Ã£o vertical de teste, firmemente fixada.</div><div class=wizard-substep><p><strong>2. Tara Inicial:</strong> Certifique-se de que nÃ£o hÃ¡ NENHUM peso sobre a cÃ©lula e clique abaixo.</p><button onclick=wizardTare() class="btn btn-primario">Fazer Tara (sem peso)</button> <span id=wizard-tare-status></span></div><div class=wizard-substep><p><strong>3. CalibraÃ§Ã£o:</strong> Coloque um peso de massa conhecida e estÃ¡vel sobre a cÃ©lula.<div style=display:flex;align-items:center;gap:.5rem><input type=number id=wizard-massa-calibracao placeholder="Massa em gramas"> <button onclick=wizardCalibrate() class="btn btn-aviso">Calibrar com esta Massa</button></div><span id=wizard-calibrate-status></span></div><div class=wizard-substep><p><strong>4. Tara Final:</strong> Retire o peso de calibraÃ§Ã£o e faÃ§a uma nova tara para finalizar.</p><button onclick=wizardTare() class="btn btn-primario">Fazer Tara Final</button></div></div><div class=wizard-step id=wizard-step-4 style=display:none><h4>Etapa 4: AnÃ¡lise de RuÃ­do</h4><p class=wizard-explanation>Com a cÃ©lula de carga vazia e estÃ¡vel, vamos analisar o ruÃ­do para melhorar a precisÃ£o das leituras.<div class=wizard-substep><p><strong>AnÃ¡lise de RuÃ­do:</strong> Certifique-se de que a cÃ©lula de carga estÃ¡ vazia e nÃ£o estÃ¡ sendo tocada.</p><button onclick=wizardAnalyzeNoise() class="btn btn-info">Analisar RuÃ­do</button> <span id=wizard-noise-status></span></div><div><label for=wizard-anti-noising-multiplier>Multiplicador de Threshold</label> <input type=number id=wizard-anti-noising-multiplier step=0.1 min=0.5 max=10 value=2.0> <small>Controla a agressividade do filtro anti-ruÃ­do. 2.0x = filtro moderado, 3.0x = agressivo.</small></div></div><div class=wizard-step id=wizard-step-5 style=display:none><h4>Etapa 5: ConclusÃ£o e Dicas</h4><p><strong>ConfiguraÃ§Ã£o ConcluÃ­da!</strong><p class=wizard-explanation>Lembre-se: antes de cada sessÃ£o de teste, e sempre que a posiÃ§Ã£o da cÃ©lula de carga for alterada, Ã© <strong>obrigatÃ³rio</strong> fazer uma nova tara (botÃ£o "Zerar (Tara)" ou atalho <kbd>Shift</kbd>+<kbd>T</kbd>).</p><label><input type=checkbox id=wizard-show-reminder> Mostrar este lembrete ao iniciar uma nova sessÃ£o.</label></div></div><div class=wizard-footer><button id=wizard-btn-prev onclick=wizardGoToStep(-1) class="btn btn-secundario">Voltar</button> <button id=wizard-btn-next onclick=wizardGoToStep(1) class="btn btn-primario">AvanÃ§ar</button> <button id=wizard-btn-finish onclick=applyWizardSettings() class="btn btn-sucesso" style=display:none>Concluir</button></div></div></div><div id=modal-nova-sessao class=wizard-modal><div class=wizard-content><div class=wizard-header><h2>ğŸš€ Nova SessÃ£o de Teste</h2><button class=wizard-close onclick=fecharModalNovaSessao()>&times;</button></div><div class=wizard-body><div class=wizard-step style=display:block><div><label for=sessao-nome>Nome da SessÃ£o</label> <input id=sessao-nome placeholder="Ex: Teste Motor XYZ v1"></div><details class=collapsible-section style=margin-top:1.5rem><summary>âš™ï¸ Metadados do Motor (Opcional)</summary><div class=grid-container style=gap:1rem;margin-top:1rem><div><label for=sessao-meta-diametro>DiÃ¢metro (mm)</label> <input type=number id=sessao-meta-diametro placeholder="Ex: 50"></div><div><label for=sessao-meta-comprimento>Comprimento (mm)</label> <input type=number id=sessao-meta-comprimento placeholder="Ex: 200"></div><div><label for=sessao-meta-fabricante>Fabricante</label> <input id=sessao-meta-fabricante placeholder="Ex: GFIG"></div><div><label for=sessao-meta-propelente>Peso do Propelente (g)</label> <input type=number id=sessao-meta-propelente placeholder="Ex: 150.5"></div><div><label for=sessao-meta-peso-total>Peso Total (g)</label> <input type=number id=sessao-meta-peso-total placeholder="Ex: 350.2"></div></div><div style=margin-top:1rem><label for=sessao-meta-descricao>DescriÃ§Ã£o</label> <textarea id=sessao-meta-descricao rows=2 placeholder="Breve descriÃ§Ã£o do motor ou do teste."></textarea></div><div style=margin-top:1rem><label for=sessao-meta-observacoes>ObservaÃ§Ãµes</label> <textarea id=sessao-meta-observacoes rows=3 placeholder="Detalhes sobre o teste, condiÃ§Ãµes, resultados inesperados, etc."></textarea></div></details><div class=grid-container style=gap:1rem;margin-top:1.5rem><div><label for=sessao-delay>Delay para Iniciar (s)</label> <input type=number id=sessao-delay value=0 min=0 step=1 title="Tempo em segundos para aguardar antes de iniciar a gravaÃ§Ã£o."></div><div><label for=sessao-timer>DuraÃ§Ã£o da GravaÃ§Ã£o (s)</label> <input type=number id=sessao-timer value=0 min=0 step=1 title="Tempo total da gravaÃ§Ã£o. Deixe em 0 para gravaÃ§Ã£o manual (sem temporizador)."> <small>Deixe em 0 para encerrar manualmente.</small></div></div></div></div><div class=wizard-footer><button onclick=fecharModalNovaSessao() class="btn btn-secundario">Cancelar</button> <button onclick=iniciarSessaoAvancado() class="btn btn-sucesso">â–¶ Iniciar GravaÃ§Ã£o</button></div></div></div>
