FROM debian:bookworm-slim

RUN apt-get update && \
    apt-get install -y --no-install-recommends \
        avahi-daemon \
    && rm -rf /var/lib/apt/lists/*

COPY avahi-service.xml /etc/avahi/services/gfig.service

# Modificar a configuração padrão do avahi para desabilitar dbus
RUN sed -i 's/^#enable-dbus=no/enable-dbus=no/' /etc/avahi/avahi-daemon.conf

EXPOSE 5353/udp

CMD ["avahi-daemon", "--no-rlimits", "--no-drop-root"]
